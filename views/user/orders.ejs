<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">


    <link href="https://fonts.googleapis.com/css?family=Cinzel:400,700|Montserrat:400,700|Roboto&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Poppins:200,300,400,500,600,700,800&display=swap"
          rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Lora:400,400i,700,700i&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Amatic+SC:400,700&display=swap" rel="stylesheet">
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Roboto:400,100,300,500,700,900|RobotoDraft:400,100,300,500,700,900">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.min.js"
    integrity="sha384-Atwg2Pkwv9vp0ygtn1JAojH0nYbwNJLPhwyoVbhoPwBhjQPR5VtM2+xf0Uwh9KtT"
    crossorigin="anonymous"></script>


    <link rel="stylesheet" href="/fonts/icomoon/style.css">
    <link rel="stylesheet" href="/fonts/ionicons/style.css">
    <link rel="stylesheet" href="/fonts/open-ionic/style.css">
    <link rel="stylesheet" href="/css/animate.css">



    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/bootstrap-datepicker.min.css">

    <link rel="stylesheet" href="/css/jquery-ui.css">
    <link rel="stylesheet" href="/css/owl.carousel.min.css">
    <link rel="stylesheet" href="/css/owl.theme.default.min.css">
    <link rel="stylesheet" href="/css/jquery.fancybox.min.css">


    <link rel="stylesheet" href="/stylesheets/bootstrap-datepicker.css">
    <link rel="stylesheet" href="/stylesheets/jquery.timepicker.css">


    <link rel="stylesheet" href="/fonts/flaticon/font/flaticon.css">

    <link rel="stylesheet" href="/css/aos.css">
    <link href="/css/jquery.mb.YTPlayer.min.css" media="all" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="/css/magnific-popup.css">



    <link rel="stylesheet" href="/css/style2.css">
    <link rel="stylesheet" href="/css/style.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-modal/2.2.6/js/bootstrap-modalmanager.min.js" integrity="sha512-/HL24m2nmyI2+ccX+dSHphAHqLw60Oj5sK8jf59VWtFWZi9vx7jzoxbZmcBeeTeCUc7z1mTs3LfyXGuBU32t+w==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


    <link
            href='https://fonts.googleapis.com/css?family=Actor|Berkshire+Swash|Great+Vibes|Josefin+Sans|Lato:300|Lobster Two|&subset=latin,latin-ext'
            rel='stylesheet' type='text/css'>

</head>


<body data-spy="scroll" data-target=".site-navbar-target" data-offset="300">
<div class="site-wrap">
    <div class="site-mobile-menu site-navbar-target">
        <div class="site-mobile-menu-header">
            <div class="site-mobile-menu-close mt-3">
                <span class="icon-close2 js-menu-toggle"></span>
            </div>
        </div>
        <div class="site-mobile-menu-body"></div>
    </div>

 


 
<div class="header-top">
  <div class="container">
      <div class="row align-items-center">
          <div class="col-12 text-center">
              <a href="/" class="site-logo">
                <img src="/img/logos/foodpanda-c.png " width="500" height="80" >
                  <!-- <img src="/images/logo.png" alt="Image" class="img-fluid"> -->
              </a>
          </div>
          <a href="#" class="mx-auto d-inline-block d-lg-none site-menu-toggle js-menu-toggle text-black"><span
                  class="icon-menu h3"></span></a>
      </div>
  </div>




  <div class="site-navbar py-2 js-sticky-header site-navbar-target d-none pl-0 d-lg-block" role="banner">

      <div class="container">
          <div class="d-flex align-items-center">

              <div class="mx-auto">
                  <nav class="site-navigation position-relative text-left" role="navigation">
                      <ul class="site-menu main-menu js-clone-nav mx-auto d-none pl-0 d-lg-block border-none">
                          <li class="active"><a href="/user/home" class="nav-link text-left">Home</a></li>
                          <li><a href="/shop/about" class="nav-link text-left">About</a></li>
                          <li class="nav-item dropdown">
                              <a class="nav-link dropdown-toggle" href="#" id="dropdown04" data-toggle="dropdown"
                                 aria-haspopup="true" aria-expanded="false">ACOUNT</a>
                              <div class="dropdown-menu" aria-labelledby="dropdown04">
                                  
                                      <a class="dropdown-item" href="/user/profile">Profile</a>
                                      <a class="dropdown-item" href="/user/logout">Logout</a>
                                  
                                      <!-- <a class="dropdown-item" href="/user/signup">Signup</a>
                                      <a class="dropdown-item" href="/user/signin">Signin</a> -->
                                  
                              </div>
                          </li>
                          <li class="nav-item dropdown">
                              <a class="nav-link dropdown-toggle" href="#" id="dropdown04" data-toggle="dropdown"
                                 aria-haspopup="true" aria-expanded="false">Shop</a>
                              <div class="dropdown-menu" aria-labelledby="dropdown04">
                                  <a class="dropdown-item" href="">Menu</a>
                                  <a class="dropdown-item" href="/user/cart">Cart</a>
                                  <a class="dropdown-item" href="/user/checkout">Checkout</a>
                              </div>
                          </li>
                         
                          <li class="nav-item cta cta-colored"><a href="http://localhost:3000/user/cart" class="nav-link"><span
                                  class="icon-shopping_cart"> </span></a></li>

                      </ul>
                  </nav>

              </div>

          </div>
      </div>

  </div>

</div>




    <!-- Jumbotron -->
   
    <section>


        <div class="container py-5 mt-5">
            <div class="row d-flex justify-content-center align-items-center h-100">
                <div class="col-12 mt-5">
                    <div class="card card-registration card-registration-2" style="border-radius: 15px">
                        <div class="card-body p-3">
                            <div class="row g-0 ">
                                <div
                                    class="d-flex align-baseline justify-content-between align-items-center">
                                    <h3>Order History</h3>
                                    <a href="/user/home" class="btn btn-primary btn-sm">
                                        <h6>&larr; Continue Shopping</h6>
                                    </a>
                                </div>
                                <hr />
                                <% if (allData.length===0) { %>
                                    <div
                                        class="d-flex flex-column align-items-center justify-content-center p-3 mt-3">
                                        <span class="material-symbols-outlined" style="font-size: 100px">
                                            list_alt
                                        </span>
                                        <h1>No Order History</h1>
                                        <a href="/user/home"
                                            style="color: #003049; text-decoration: none">Continue
                                            Shopping</a>
                                    </div>
                                    <% } else {%>
                                        <%allData.forEach(data=> { %>
                                            <div class="col-md-12 p-3" style="border: 1px solid">
                                                <div class="row">
                                                    <div
                                                        class="col-md-3 justify-content-center d-flex flex-column align-item-center">
                                                        <div><b>Order Id: </b> #<%= data.order_id %>
                                                        </div>
                                                        <div>
                                                            <button type="button"
                                                                class="btn btn-primary btn-sm"
                                                                data-bs-toggle="modal"
                                                                data-bs-target="#model-<%= data.order_id %>">
                                                                View Products
                                                            </button>
                                                        </div>
                                                    </div>
                                                    <div class="modal fade" id="model-<%= data.order_id %>"
                                                        tabindex="-1"
                                                        aria-labelledby="<%= data.order_id %>Label"
                                                        aria-hidden="true">
                                                        <div class="modal-dialog">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h1 class="modal-title fs-5"
                                                                        id="<%= data.order_id %>Label">
                                                                        Products
                                                                    </h1>
                                                                    <button type="button" class="btn-close"
                                                                        data-bs-dismiss="modal"
                                                                        aria-label="Close"></button>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <div class="p-3">
                                                                        <div
                                                                            class="d-flex flex-column justify-content-center">
                                                                            <% productData.forEach(element=>
                                                                                { %> <% if
                                                                                    (data.order_id==element.order_id+'')
                                                                                    { %>
                                                                                    <div class="d-flex justify-content-start"
                                                                                        style="border: 0.5px solid #d9d9d9">
                                                                                        <div>
                                                                                            <img src="<%= element.productDetail.image %>"
                                                                                                alt=""
                                                                                                style="width: 100px; height: 100px" />
                                                                                        </div>
                                                                                        <div>
                                                                                            <div>
                                                                                                <%= element.productDetail.item_name
                                                                                                    %>
                                                                                            </div>
                                                                                            <div>Qty: <%=
                                                                                                    element.productQuantity
                                                                                                    %>
                                                                                            </div>
                                                                                            <div>Size: <%=
                                                                                                    element.productSize
                                                                                                    %>
                                                                                            </div>
                                                                                            <div>Total: <%=
                                                                                                    element.productPrice
                                                                                                    %>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                    <% } %>
                                                                                        <% }) %>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="modal-footer">
                                                                    <button type="button"
                                                                        class="btn btn-secondary"
                                                                        data-bs-dismiss="modal">
                                                                        Close
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div
                                                        class="col-md-3 justify-content-center d-flex flex-column align-items-center">
                                                        <dl>
                                                            <dt>items</dt>
                                                            <dd>
                                                                <ul>
                                                                    <% productData.forEach(element=> { %> <%
                                                                            if (data._id+''==''
                                                                            +element._id) { %>
                                                                            <li>
                                                                                <%= element.productDetail.item_name
                                                                                    %> &times; <%=
                                                                                        element.productQuantity
                                                                                        %>
                                                                            </li>
                                                                            <% } %>
                                                                                <% }) %>
                                                                </ul>
                                                            </dd>
                                                        </dl>
                                                    </div>
                                                    <div class="col-md-3 d-flex flex-column">
                                                        <b>Total Amount:</b>&nbsp;Rs.<%= data.totalAmount %>
                                                            <br />
                                                            <b>Payment:</b>
                                                            <%= data.paymentMethod %>(<%= data.paymentStatus
                                                                    %>)
                                                    </div>
                                                    <div class="col-md-3 d-flex flex-column">
                                                        <b>Order Status: </b>
                                                        <%= data.orderStatus %> <br />
                                                            <b>delivery expected: </b>
                                                            <%= data.expectedDelivery %>
                                                    </div>
                                                    <div class="col-md-12 d-flex justify-content-center">
                                                        <!-- Modal -->
                                                    </div>
                                                </div>
                                            </div>
                                            <% }) %>
                                                <% } %>



                            </div>
                        </div>
                    </div>
                </div>




    </section>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>

<script>
    
    function changeQuantity(cartId, productId, count) {
  $.ajax({
    url: '/user/cartQuantity',
    data: {
      cart: cartId,
      product: productId,
      count,
    },
    method: 'post',
    success: (res) => {
      // document.getElementById('quantity').innerText = Number(qty) + Number(count);
      location.reload();
      // $('#quantity').load(`${document.URL} #quantity`);
    },
  });
}

function deleteProduct(cartId, productId) {
  $.ajax({
    url: '/user/deleteProduct',
    data: {
      cart: cartId,
      product: productId,
    },
    method: 'post',
    success: () => {
      Swal.fire({
        title: 'Are you sure?',
        text: "You won't be able to revert this!",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Yes, delete it!',
      }).then((result) => {
        if (result.isConfirmed) {
          Swal.fire(
            'Deleted!',
            'Your file has been deleted.',
            'success',
          );
        }
      }).then(() => {
        location.reload();
      });
    },
  });
}
    </script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
    crossorigin="anonymous"></script>



<%- include('../partials/userFooter.ejs') %>



